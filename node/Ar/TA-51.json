{
	"info": {
		"_postman_id": "2885adaf-4017-4eef-b20e-5e42c0a6bdb1",
		"name": "TA-51",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "6765444",
		"_collection_link": "https://ongageqa.postman.co/workspace/Automation-Rules~787500f5-12b4-4a1c-8876-ef4ee137a15d/collection/6765444-2885adaf-4017-4eef-b20e-5e42c0a6bdb1?action=share&creator=6765444&source=collection_link"
	},
	"item": [
		{
			"name": "Get automation rule",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"var jsonData = pm.response.json();",
							"count = 0",
							"jsonData.payload.forEach(function(data, index) {",
							"    if(data.name===\"TA-99\"){",
							"        count += 1",
							"        pm.globals.set(\"automation_rule_id_ta-99\", data.id);",
							"        if(data.active === false){",
							"            postman.setNextRequest(\"delete_AR\");",
							"        }",
							"    }",
							"})",
							"if(count === 0 ){",
							"\tpostman.setNextRequest(\"Get_automation_rule_1\");",
							"}",
							"",
							"",
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"protocolProfileBehavior": {
				"disableBodyPruning": true
			},
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "X_USERNAME",
						"type": "text",
						"value": "{{username}}"
					},
					{
						"key": "X_PASSWORD",
						"type": "text",
						"value": "{{password}}"
					},
					{
						"key": "X_ACCOUNT_CODE",
						"type": "text",
						"value": "{{account_code}}"
					},
					{
						"key": "Content-Type",
						"name": "Content-Type",
						"type": "text",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": ""
				},
				"url": {
					"raw": "{{api_domain}}/{{list_id}}/api/automation_rule",
					"host": [
						"{{api_domain}}"
					],
					"path": [
						"{{list_id}}",
						"api",
						"automation_rule"
					]
				}
			},
			"response": []
		},
		{
			"name": "Deactivate automation rule",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "PUT",
				"header": [
					{
						"key": "X_USERNAME",
						"type": "text",
						"value": "{{username}}"
					},
					{
						"key": "X_PASSWORD",
						"type": "text",
						"value": "{{password}}"
					},
					{
						"key": "X_ACCOUNT_CODE",
						"type": "text",
						"value": "{{account_code}}"
					},
					{
						"key": "Content-Type",
						"name": "Content-Type",
						"type": "text",
						"value": "text/plain"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\"active\": false}"
				},
				"url": {
					"raw": "{{api_domain}}/{{list_id}}/api/automation_rule/{{automation_rule_id_ta-99}}",
					"host": [
						"{{api_domain}}"
					],
					"path": [
						"{{list_id}}",
						"api",
						"automation_rule",
						"{{automation_rule_id_ta-99}}"
					]
				}
			},
			"response": []
		},
		{
			"name": "delete_AR",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.globals.unset(\"automation_rule_id_ta-99\");"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "DELETE",
				"header": [
					{
						"key": "X_USERNAME",
						"type": "text",
						"value": "{{username}}"
					},
					{
						"key": "X_PASSWORD",
						"type": "text",
						"value": "{{password}}"
					},
					{
						"key": "X_ACCOUNT_CODE",
						"type": "text",
						"value": "{{account_code}}"
					}
				],
				"body": {
					"mode": "raw",
					"raw": ""
				},
				"url": {
					"raw": "{{api_domain}}/{{list_id}}/api/automation_rule/{{automation_rule_id_ta-99}}",
					"host": [
						"{{api_domain}}"
					],
					"path": [
						"{{list_id}}",
						"api",
						"automation_rule",
						"{{automation_rule_id_ta-99}}"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get_automation_rule_1",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"var jsonData = pm.response.json();",
							"count = 0",
							"jsonData.payload.forEach(function(data, index) {",
							"    if(data.name===\"TA-51\"){",
							"        count += 1",
							"        pm.globals.set(\"automation_rule_id_ta-51\", data.id);",
							"        if(data.active === false){",
							"            postman.setNextRequest(\"delete_AR_1\");",
							"        }",
							"    }",
							"})",
							"if(count === 0 ){",
							"\tpostman.setNextRequest(\"create_AR\");",
							"}",
							"",
							"",
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"protocolProfileBehavior": {
				"disableBodyPruning": true
			},
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "X_USERNAME",
						"type": "text",
						"value": "{{username}}"
					},
					{
						"key": "X_PASSWORD",
						"type": "text",
						"value": "{{password}}"
					},
					{
						"key": "X_ACCOUNT_CODE",
						"type": "text",
						"value": "{{account_code}}"
					},
					{
						"key": "Content-Type",
						"name": "Content-Type",
						"type": "text",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": ""
				},
				"url": {
					"raw": "{{api_domain}}/{{list_id}}/api/automation_rule",
					"host": [
						"{{api_domain}}"
					],
					"path": [
						"{{list_id}}",
						"api",
						"automation_rule"
					]
				}
			},
			"response": []
		},
		{
			"name": "Deactivate_automation_rule_1",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "PUT",
				"header": [
					{
						"key": "X_USERNAME",
						"type": "text",
						"value": "{{username}}"
					},
					{
						"key": "X_PASSWORD",
						"type": "text",
						"value": "{{password}}"
					},
					{
						"key": "X_ACCOUNT_CODE",
						"type": "text",
						"value": "{{account_code}}"
					},
					{
						"key": "Content-Type",
						"name": "Content-Type",
						"type": "text",
						"value": "text/plain"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\"active\": false}"
				},
				"url": {
					"raw": "{{api_domain}}/{{list_id}}/api/automation_rule/{{automation_rule_id_ta-51}}",
					"host": [
						"{{api_domain}}"
					],
					"path": [
						"{{list_id}}",
						"api",
						"automation_rule",
						"{{automation_rule_id_ta-51}}"
					]
				}
			},
			"response": []
		},
		{
			"name": "delete_AR_1",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.globals.unset(\"automation_rule_id_ta-51\");"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "DELETE",
				"header": [
					{
						"key": "X_USERNAME",
						"type": "text",
						"value": "{{username}}"
					},
					{
						"key": "X_PASSWORD",
						"type": "text",
						"value": "{{password}}"
					},
					{
						"key": "X_ACCOUNT_CODE",
						"type": "text",
						"value": "{{account_code}}"
					}
				],
				"body": {
					"mode": "raw",
					"raw": ""
				},
				"url": {
					"raw": "{{api_domain}}/{{list_id}}/api/automation_rule/{{automation_rule_id_ta-51}}",
					"host": [
						"{{api_domain}}"
					],
					"path": [
						"{{list_id}}",
						"api",
						"automation_rule",
						"{{automation_rule_id_ta-51}}"
					]
				}
			},
			"response": []
		},
		{
			"name": "create_AR",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"var jsonData = pm.response.json();",
							"pm.globals.set(\"automation_rule_id\", jsonData.payload.id);",
							""
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"pm.globals.set(\"now_time\",pm.globals.get(\"$timestamp\")); ",
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "POST",
				"header": [
					{
						"key": "X_USERNAME",
						"type": "text",
						"value": "{{username}}"
					},
					{
						"key": "X_PASSWORD",
						"type": "text",
						"value": "{{password}}"
					},
					{
						"key": "X_ACCOUNT_CODE",
						"type": "text",
						"value": "{{account_code}}"
					},
					{
						"key": "Content-Type",
						"name": "Content-Type",
						"type": "text",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"name\": \"TA-99\",\n    \"description\": \"abc\",\n    \"trigger\": \"clicked\",\n    \"trigger_frequency\": \"once\",\n    \"btn_save\": \"\",\n    \"trigger_sources\": [\n        \"recipient_action\"\n    ],\n    \"criteria\": [\n        {\n        \t \"condition\": \"and\",\n            \"group\": \"\",\n            \"field_id\": {{list_field_gender_id}},\n            \"field_name\": \"\",\n            \"type\": \"string\",\n            \"position\": \"0\",\n            \"changed\": \"\",\n            \"operator\": \"=\",\n            \"case_sensitive\": \"1\",\n            \"operand\": [\n                \"male\"\n            ]\n        },\n        {\n            \"condition\": \"and\",\n            \"field_name\": \"ocx_status\",\n            \"type\": \"enum\",\n            \"operator\": \"=\",\n            \"position\": 1,\n            \"changed\": \"\",\n            \"operand\": [\n                \"active\"\n            ],\n            \"group\": null,\n            \"left_parenthesis\": 0,\n            \"right_parenthesis\": 0\n        }\n    ],\n    \"actions\": [\n        {\n        \t\"name\": \"TA-51 Transactional Action\",\n\t\t\t\"action_number\":1,\n\t\t\t\"type\":\"transactional\",\n\t\t\t\"data\":{\n\t\t\t\t\"message_id\":{{email_message_id}},\n\t\t\t\t\"campaign_id\":{{tmailing_id}},\n\t\t\t\t\"sending_connection_id\":{{esp_id}}\n\t\t\t},\n\t\t\t\"active\":true,\n\t\t\t\"position\":0\n\t\t},\n        {\n            \"name\": \"TA-51 Webhook Action\",\n            \"action_number\": 2,\n            \"type\": \"webhook\",\n            \"data\": {\n                \"http_method\": \"post\",\n                \"url\": \"https://automated_tests-l2.ongage.net/webhook_testing/ta51\",\n                \"selected_fields\": [\n                    \"email\",\n                    \"address\",\n                    \"country\"\n                ]\n            },\n            \"active\": true,\n            \"position\": 1\n        },\n        {\n        \t\"name\": \"TA-51 Update Field Action\",\n            \"action_number\": 3,\n            \"type\": \"update_field\",\n            \"data\": {\n                \"field_id\": {{list_field_last_name}},\n                \"operator\": \"overwrite\",\n                \"value\": \"{{last_name}}\"\n            },\n            \"active\": true,\n            \"position\": 2\n        }\n    ]\n}"
				},
				"url": {
					"raw": "{{api_domain}}/{{list_id}}/api/automation_rule/",
					"host": [
						"{{api_domain}}"
					],
					"path": [
						"{{list_id}}",
						"api",
						"automation_rule",
						""
					]
				}
			},
			"response": []
		},
		{
			"name": "Activate automation rule",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "PUT",
				"header": [
					{
						"key": "X_USERNAME",
						"type": "text",
						"value": "{{username}}"
					},
					{
						"key": "X_PASSWORD",
						"type": "text",
						"value": "{{password}}"
					},
					{
						"key": "X_ACCOUNT_CODE",
						"type": "text",
						"value": "{{account_code}}"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\"active\": true}"
				},
				"url": {
					"raw": "{{api_domain}}/{{list_id}}/api/automation_rule/{{automation_rule_id}}",
					"host": [
						"{{api_domain}}"
					],
					"path": [
						"{{list_id}}",
						"api",
						"automation_rule",
						"{{automation_rule_id}}"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get automation info",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"var jsonData = pm.response.json();",
							"pm.test(\"Test Activate automation rule\", function() {",
							"    pm.expect(jsonData.payload.active).to.eql(true);",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"protocolProfileBehavior": {
				"disableBodyPruning": true
			},
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "X_USERNAME",
						"type": "text",
						"value": "{{username}}"
					},
					{
						"key": "X_PASSWORD",
						"type": "text",
						"value": "{{password}}"
					},
					{
						"key": "X_ACCOUNT_CODE",
						"type": "text",
						"value": "{{account_code}}"
					},
					{
						"key": "Content-Type",
						"name": "Content-Type",
						"type": "text",
						"value": "text/plain"
					}
				],
				"body": {
					"mode": "raw",
					"raw": ""
				},
				"url": {
					"raw": "{{api_domain}}/{{list_id}}/api/automation_rule/{{automation_rule_id}}?include_actions=1",
					"host": [
						"{{api_domain}}"
					],
					"path": [
						"{{list_id}}",
						"api",
						"automation_rule",
						"{{automation_rule_id}}"
					],
					"query": [
						{
							"key": "include_actions",
							"value": "1"
						}
					]
				}
			},
			"response": []
		},
		{
			"name": "Update automation rule general fields",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "PUT",
				"header": [
					{
						"key": "X_USERNAME",
						"type": "text",
						"value": "{{username}}"
					},
					{
						"key": "X_PASSWORD",
						"type": "text",
						"value": "{{password}}"
					},
					{
						"key": "X_ACCOUNT_CODE",
						"type": "text",
						"value": "{{account_code}}"
					},
					{
						"key": "Content-Type",
						"name": "Content-Type",
						"value": "application/json",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"name\": \"TA-51\",\n    \"description\": \"xyz\"\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{api_domain}}/{{list_id}}/api/automation_rule/{{automation_rule_id}}",
					"host": [
						"{{api_domain}}"
					],
					"path": [
						"{{list_id}}",
						"api",
						"automation_rule",
						"{{automation_rule_id}}"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get automation info",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"var jsonData = pm.response.json();",
							"pm.test(\"Test update automation rule general fields\", function() {",
							"    pm.expect(jsonData.payload.description).to.eql(\"xyz\");",
							"    pm.expect(jsonData.payload.name).to.eql(\"TA-51\");",
							"});",
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"protocolProfileBehavior": {
				"disableBodyPruning": true
			},
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "X_USERNAME",
						"type": "text",
						"value": "{{username}}"
					},
					{
						"key": "X_PASSWORD",
						"type": "text",
						"value": "{{password}}"
					},
					{
						"key": "X_ACCOUNT_CODE",
						"type": "text",
						"value": "{{account_code}}"
					},
					{
						"key": "Content-Type",
						"name": "Content-Type",
						"type": "text",
						"value": "text/plain"
					}
				],
				"body": {
					"mode": "raw",
					"raw": ""
				},
				"url": {
					"raw": "{{api_domain}}/{{list_id}}/api/automation_rule/{{automation_rule_id}}?include_actions=1",
					"host": [
						"{{api_domain}}"
					],
					"path": [
						"{{list_id}}",
						"api",
						"automation_rule",
						"{{automation_rule_id}}"
					],
					"query": [
						{
							"key": "include_actions",
							"value": "1"
						}
					]
				}
			},
			"response": []
		},
		{
			"name": "Update automation rule criteria",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "PUT",
				"header": [
					{
						"key": "X_USERNAME",
						"type": "text",
						"value": "{{username}}"
					},
					{
						"key": "X_PASSWORD",
						"type": "text",
						"value": "{{password}}"
					},
					{
						"key": "X_ACCOUNT_CODE",
						"type": "text",
						"value": "{{account_code}}"
					},
					{
						"key": "Content-Type",
						"name": "Content-Type",
						"value": "application/json",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"name\": \"TA-51\",\n\t\"trigger\": \"clicked\",\n\n    \"criteria\": [\n        {\n        \t\"condition\": \"and\",\n            \"group\": \"\",\n            \"field_id\": {{list_field_email}},\n            \"field_name\": \"\",\n            \"type\": \"email\",\n            \"position\": 0,\n            \"changed\": \"\",\n            \"operator\": \"=\",\n            \"operand\": [\n                \"ta-51@hoohem.com\"\n            ],\n            \"left_parenthesis\": 0,\n            \"right_parenthesis\": 0\n        },\n        {\n            \"condition\": \"and\",\n            \"field_name\": \"ocx_status\",\n            \"type\": \"enum\",\n            \"operator\": \"=\",\n            \"position\": 1,\n            \"changed\": \"\",\n            \"operand\": [\n                \"active\"\n            ],\n            \"group\": null,\n            \"left_parenthesis\": 0,\n            \"right_parenthesis\": 0\n        }\n    ]\n}"
				},
				"url": {
					"raw": "{{api_domain}}/{{list_id}}/api/automation_rule/{{automation_rule_id}}",
					"host": [
						"{{api_domain}}"
					],
					"path": [
						"{{list_id}}",
						"api",
						"automation_rule",
						"{{automation_rule_id}}"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get automation info",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"var jsonData = pm.response.json();",
							"",
							"pm.test(\"Test update automation rule criteria\", function() {",
							"    pm.expect(jsonData.payload.criteria[0].field_id).to.eql(parseInt(pm.environment.get(\"list_field_email\")));",
							"    pm.expect(jsonData.payload.criteria[0].operator).to.eql(\"=\");",
							"    pm.expect(jsonData.payload.criteria[0].operand[0]).to.eql(\"ta-51@hoohem.com\");",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"protocolProfileBehavior": {
				"disableBodyPruning": true
			},
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "X_USERNAME",
						"type": "text",
						"value": "{{username}}"
					},
					{
						"key": "X_PASSWORD",
						"type": "text",
						"value": "{{password}}"
					},
					{
						"key": "X_ACCOUNT_CODE",
						"type": "text",
						"value": "{{account_code}}"
					},
					{
						"key": "Content-Type",
						"name": "Content-Type",
						"type": "text",
						"value": "text/plain"
					}
				],
				"body": {
					"mode": "raw",
					"raw": ""
				},
				"url": {
					"raw": "{{api_domain}}/{{list_id}}/api/automation_rule/{{automation_rule_id}}?include_actions=1",
					"host": [
						"{{api_domain}}"
					],
					"path": [
						"{{list_id}}",
						"api",
						"automation_rule",
						"{{automation_rule_id}}"
					],
					"query": [
						{
							"key": "include_actions",
							"value": "1"
						}
					]
				}
			},
			"response": []
		},
		{
			"name": "Update automation rule existing actions",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "PUT",
				"header": [
					{
						"key": "X_USERNAME",
						"type": "text",
						"value": "{{username}}"
					},
					{
						"key": "X_PASSWORD",
						"type": "text",
						"value": "{{password}}"
					},
					{
						"key": "X_ACCOUNT_CODE",
						"type": "text",
						"value": "{{account_code}}"
					},
					{
						"key": "Content-Type",
						"name": "Content-Type",
						"value": "application/json",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"name\": \"TA-51\",\n    \"actions\": [\n\t\t{\n\t\t\t\"name\": \"TA-51 Transactional Action\",\n\t\t\t\"action_number\":1,\n\t\t\t\"type\":\"transactional\",\n\t\t\t\"data\":{\n\t\t\t\t\"message_id\":{{ta_51_email_message_id}},\n\t\t\t\t\"campaign_id\":{{ta_51_mailing_id}},\n\t\t\t\t\"sending_connection_id\":{{esp_id}}\n\t\t\t},\n\t\t\t\"active\":true,\n\t\t\t\"position\":0\n\t\t},\n        {\n        \t\"name\": \"TA-51 Webhook Action\",\n            \"action_number\": 2,\n            \"type\": \"webhook\",\n            \"data\": {\n                \"http_method\": \"post\",\n                \"url\": \"https://automated_tests-l2.ongage.net/webhook_testing/ta51\",\n                \"selected_fields\": [\n                    \"email\",\n                    \"address\",\n                    \"country\"\n                ]\n            },\n            \"active\": true,\n            \"position\": 1\n        },\n        {\n        \t\"name\": \"TA-51 Update Field Action\",\n            \"action_number\": 3,\n            \"type\": \"update_field\",\n            \"data\": {\n                \"field_id\": {{list_field_last_name}},\n                \"operator\": \"overwrite\",\n                \"value\": \"{{last_name}}\"\n            },\n            \"active\": true,\n            \"position\": 2\n        }\n    ]\n}"
				},
				"url": {
					"raw": "{{api_domain}}/{{list_id}}/api/automation_rule/{{automation_rule_id}}",
					"host": [
						"{{api_domain}}"
					],
					"path": [
						"{{list_id}}",
						"api",
						"automation_rule",
						"{{automation_rule_id}}"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get automation info",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"var jsonData = pm.response.json();",
							"",
							"pm.test(\"Test update automation rule action\", function() {",
							"    pm.expect(jsonData.payload.actions[0].type).to.eql(\"transactional\");",
							"    pm.expect(jsonData.payload.actions[0].data[\"campaign_id\"]).to.eql(parseInt(pm.environment.get(\"ta_51_mailing_id\")));",
							"    pm.expect(jsonData.payload.actions[0].data[\"message_id\"]).to.eql(parseInt(pm.environment.get(\"ta_51_email_message_id\")));",
							"});",
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"protocolProfileBehavior": {
				"disableBodyPruning": true
			},
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "X_USERNAME",
						"type": "text",
						"value": "{{username}}"
					},
					{
						"key": "X_PASSWORD",
						"type": "text",
						"value": "{{password}}"
					},
					{
						"key": "X_ACCOUNT_CODE",
						"type": "text",
						"value": "{{account_code}}"
					},
					{
						"key": "Content-Type",
						"name": "Content-Type",
						"type": "text",
						"value": "text/plain"
					}
				],
				"body": {
					"mode": "raw",
					"raw": ""
				},
				"url": {
					"raw": "{{api_domain}}/{{list_id}}/api/automation_rule/{{automation_rule_id}}?include_actions=1",
					"host": [
						"{{api_domain}}"
					],
					"path": [
						"{{list_id}}",
						"api",
						"automation_rule",
						"{{automation_rule_id}}"
					],
					"query": [
						{
							"key": "include_actions",
							"value": "1"
						}
					]
				}
			},
			"response": []
		},
		{
			"name": "Update automation rule existing actions and add new actions",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "PUT",
				"header": [
					{
						"key": "X_USERNAME",
						"type": "text",
						"value": "{{username}}"
					},
					{
						"key": "X_PASSWORD",
						"type": "text",
						"value": "{{password}}"
					},
					{
						"key": "X_ACCOUNT_CODE",
						"type": "text",
						"value": "{{account_code}}"
					},
					{
						"key": "Content-Type",
						"name": "Content-Type",
						"value": "application/json",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"name\": \"TA-51\",\n    \"actions\": [\n    \t{\n    \t\t\"name\": \"TA-51 Transactional Action\",\n\t\t\t\"action_number\":1,\n\t\t\t\"type\":\"transactional\",\n\t\t\t\"data\":{\n\t\t\t\t\"message_id\":{{email_message_id}},\n\t\t\t\t\"campaign_id\":{{ta_51_mailing_id}},\n\t\t\t\t\"sending_connection_id\":{{esp_id}}\n\t\t\t},\n\t\t\t\"active\":true,\n\t\t\t\"position\":0\n\t\t},\n        {\n        \t\"name\": \"TA-51 Webhook Action\",\n            \"action_number\": 2,\n            \"type\": \"webhook\",\n            \"data\": {\n                \"http_method\": \"post\",\n                \"url\": \"https://automated_tests-l2.ongage.net/webhook_testing/ta51\",\n                \"selected_fields\": [\n                    \"email\",\n                    \"address\",\n                    \"country\"\n                ]\n            },\n            \"active\": true,\n            \"position\": 1\n        },\n        {\n        \t\"name\": \"TA-51 Update Field Action\",\n            \"action_number\": 3,\n            \"type\": \"update_field\",\n            \"data\": {\n                \"field_id\": {{list_field_last_name}},\n                \"operator\": \"overwrite\",\n                \"value\": \"{{last_name}}\"\n            },\n            \"active\": true,\n            \"position\": 2\n        },\n        {\n        \t\"name\": \"TA-51 Webhook Action 2\",\n            \"action_number\": 4,\n            \"type\": \"webhook\",\n            \"data\": {\n                \"http_method\": \"post\",\n                \"url\": \"https://automated_tests-l2.ongage.net/webhook_testing/ta51\",\n                \"selected_fields\": [\n                    \"country\",\n                    \"last_name\"\n                ]\n            },\n            \"active\": true,\n            \"position\": 3\n        }\n    ]\n}"
				},
				"url": {
					"raw": "{{api_domain}}/{{list_id}}/api/automation_rule/{{automation_rule_id}}",
					"host": [
						"{{api_domain}}"
					],
					"path": [
						"{{list_id}}",
						"api",
						"automation_rule",
						"{{automation_rule_id}}"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get automation info",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"var jsonData = pm.response.json();",
							"",
							"pm.test(\"Test update automation rule existing actions and add new actions\", function() {",
							"    pm.expect(jsonData.payload.actions[0].type).to.eql(\"transactional\");",
							"    pm.expect(jsonData.payload.actions[0].data[\"campaign_id\"]).to.eql(parseInt(pm.environment.get(\"ta_51_mailing_id\")));",
							"    pm.expect(jsonData.payload.actions[0].data[\"message_id\"]).to.eql(parseInt(pm.environment.get(\"email_message_id\")));",
							"    pm.expect(jsonData.payload.actions[3].type).to.eql(\"webhook\");",
							"    ",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"protocolProfileBehavior": {
				"disableBodyPruning": true
			},
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "X_USERNAME",
						"type": "text",
						"value": "{{username}}"
					},
					{
						"key": "X_PASSWORD",
						"type": "text",
						"value": "{{password}}"
					},
					{
						"key": "X_ACCOUNT_CODE",
						"type": "text",
						"value": "{{account_code}}"
					},
					{
						"key": "Content-Type",
						"name": "Content-Type",
						"type": "text",
						"value": "text/plain"
					}
				],
				"body": {
					"mode": "raw",
					"raw": ""
				},
				"url": {
					"raw": "{{api_domain}}/{{list_id}}/api/automation_rule/{{automation_rule_id}}?include_actions=1",
					"host": [
						"{{api_domain}}"
					],
					"path": [
						"{{list_id}}",
						"api",
						"automation_rule",
						"{{automation_rule_id}}"
					],
					"query": [
						{
							"key": "include_actions",
							"value": "1"
						}
					]
				}
			},
			"response": []
		},
		{
			"name": "Update automation rule with new actions only",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "PUT",
				"header": [
					{
						"key": "X_USERNAME",
						"type": "text",
						"value": "{{username}}"
					},
					{
						"key": "X_PASSWORD",
						"type": "text",
						"value": "{{password}}"
					},
					{
						"key": "X_ACCOUNT_CODE",
						"type": "text",
						"value": "{{account_code}}"
					},
					{
						"key": "Content-Type",
						"name": "Content-Type",
						"value": "application/json",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"name\": \"TA-51\",\n    \"actions\": [\n        {\n        \t\"name\": \"TA-51 Transactional Action\",\n\t\t\t\"action_number\":1,\n\t\t\t\"type\":\"transactional\",\n\t\t\t\"data\":{\n\t\t\t\t\"message_id\":{{email_message_id}},\n\t\t\t\t\"campaign_id\":{{ta_51_mailing_id}},\n\t\t\t\t\"sending_connection_id\":{{esp_id}}\n\t\t\t},\n\t\t\t\"active\":true,\n\t\t\t\"position\":0\n\t\t},\n        {\n        \t\"name\": \"TA-51 Webhook Action\",\n            \"action_number\": 2,\n            \"type\": \"webhook\",\n            \"data\": {\n                \"http_method\": \"post\",\n                \"url\": \"https://automated_tests-l2.ongage.net/webhook_testing/ta51\",\n                \"selected_fields\": [\n                    \"email\",\n                    \"address\",\n                    \"country\"\n                ]\n            },\n            \"active\": true,\n            \"position\": 1\n        },\n        {\n        \t\"name\": \"TA-51 Update Field Action\",\n            \"action_number\": 3,\n            \"type\": \"update_field\",\n            \"data\": {\n                \"field_id\": {{list_field_last_name}},\n                \"operator\": \"overwrite\",\n                \"value\": \"{{last_name}}\"\n            },\n            \"active\": true,\n            \"position\": 2\n        },\n        {\n        \t\"name\": \"TA-51 Webhook Action 2\",\n            \"action_number\": 4,\n            \"type\": \"webhook\",\n            \"data\": {\n                \"http_method\": \"post\",\n                \"url\": \"https://automated_tests-l2.ongage.net/webhook_testing/ta51\",\n                \"selected_fields\": [\n                    \"country\",\n                    \"last_name\"\n                ]\n            },\n            \"active\": true,\n            \"position\": 3\n        },\n        {\n        \t\"name\": \"TA-51 Update Field Action 2\",\n            \"action_number\": 5,\n            \"type\": \"update_field\",\n            \"data\": {\n                \"field_id\": {{list_field_last_name}},\n                \"operator\": \"overwrite\",\n                \"value\": \"{{first_name}}\"\n            },\n            \"active\": true,\n            \"position\": 4\n        }\n    ]\n}"
				},
				"url": {
					"raw": "{{api_domain}}/{{list_id}}/api/automation_rule/{{automation_rule_id}}",
					"host": [
						"{{api_domain}}"
					],
					"path": [
						"{{list_id}}",
						"api",
						"automation_rule",
						"{{automation_rule_id}}"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get automation info",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"var jsonData = pm.response.json();",
							"pm.test(\"Test automation rule with add new actions only\", function() {",
							"    pm.expect(jsonData.payload.actions[4].type).to.eql(\"update_field\");",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"protocolProfileBehavior": {
				"disableBodyPruning": true
			},
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "X_USERNAME",
						"type": "text",
						"value": "{{username}}"
					},
					{
						"key": "X_PASSWORD",
						"type": "text",
						"value": "{{password}}"
					},
					{
						"key": "X_ACCOUNT_CODE",
						"type": "text",
						"value": "{{account_code}}"
					},
					{
						"key": "Content-Type",
						"name": "Content-Type",
						"type": "text",
						"value": "text/plain"
					}
				],
				"body": {
					"mode": "raw",
					"raw": ""
				},
				"url": {
					"raw": "{{api_domain}}/{{list_id}}/api/automation_rule/{{automation_rule_id}}?include_actions=1",
					"host": [
						"{{api_domain}}"
					],
					"path": [
						"{{list_id}}",
						"api",
						"automation_rule",
						"{{automation_rule_id}}"
					],
					"query": [
						{
							"key": "include_actions",
							"value": "1"
						}
					]
				}
			},
			"response": []
		},
		{
			"name": "Deactivate automation rule",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "PUT",
				"header": [
					{
						"key": "X_USERNAME",
						"type": "text",
						"value": "{{username}}"
					},
					{
						"key": "X_PASSWORD",
						"type": "text",
						"value": "{{password}}"
					},
					{
						"key": "X_ACCOUNT_CODE",
						"type": "text",
						"value": "{{account_code}}"
					},
					{
						"key": "Content-Type",
						"name": "Content-Type",
						"type": "text",
						"value": "text/plain"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\"active\": false}"
				},
				"url": {
					"raw": "{{api_domain}}/{{list_id}}/api/automation_rule/{{automation_rule_id}}",
					"host": [
						"{{api_domain}}"
					],
					"path": [
						"{{list_id}}",
						"api",
						"automation_rule",
						"{{automation_rule_id}}"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get automation info",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"var jsonData = pm.response.json();",
							"pm.test(\"Test Deactivate automation rule\", function() {",
							"    pm.expect(jsonData.payload.active).to.eql(false);",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"protocolProfileBehavior": {
				"disableBodyPruning": true
			},
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "X_USERNAME",
						"type": "text",
						"value": "{{username}}"
					},
					{
						"key": "X_PASSWORD",
						"type": "text",
						"value": "{{password}}"
					},
					{
						"key": "X_ACCOUNT_CODE",
						"type": "text",
						"value": "{{account_code}}"
					},
					{
						"key": "Content-Type",
						"name": "Content-Type",
						"type": "text",
						"value": "text/plain"
					}
				],
				"body": {
					"mode": "raw",
					"raw": ""
				},
				"url": {
					"raw": "{{api_domain}}/{{list_id}}/api/automation_rule/{{automation_rule_id}}?include_actions=1",
					"host": [
						"{{api_domain}}"
					],
					"path": [
						"{{list_id}}",
						"api",
						"automation_rule",
						"{{automation_rule_id}}"
					],
					"query": [
						{
							"key": "include_actions",
							"value": "1"
						}
					]
				}
			},
			"response": []
		},
		{
			"name": "Activate automation rule with criteria and actions update",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "PUT",
				"header": [
					{
						"key": "X_USERNAME",
						"type": "text",
						"value": "{{username}}"
					},
					{
						"key": "X_PASSWORD",
						"type": "text",
						"value": "{{password}}"
					},
					{
						"key": "X_ACCOUNT_CODE",
						"type": "text",
						"value": "{{account_code}}"
					},
					{
						"key": "Content-Type",
						"name": "Content-Type",
						"value": "application/json",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"name\": \"TA-51\",\n    \"active\":true,\n    \"trigger\": \"opened\",\n    \"criteria\": [\n        {\n            \"condition\": \"and\",\n            \"group\": \"\",\n            \"field_id\": {{list_field_email}},\n            \"field_name\": \"\",\n            \"type\": \"email\",\n            \"position\": 0,\n            \"changed\": \"\",\n            \"operator\": \"=\",\n            \"operand\": [\n                \"ta-51@hoohem.com\"\n            ],\n            \"left_parenthesis\": 0,\n            \"right_parenthesis\": 0\n        },\n        {\n            \"condition\": \"and\",\n            \"field_name\": \"ocx_status\",\n            \"type\": \"enum\",\n            \"operator\": \"=\",\n            \"position\": 1,\n            \"changed\": \"\",\n            \"operand\": [\n                \"active\"\n            ],\n            \"group\": null,\n            \"left_parenthesis\": 0,\n            \"right_parenthesis\": 0\n        }\n    ],\n    \"actions\": [\n    \t{\n    \t\t\"name\": \"TA-51 Transactional Action\",\n\t\t\t\"action_number\":1,\n\t\t\t\"type\":\"transactional\",\n\t\t\t\"data\":{\n\t\t\t\t\"message_id\":{{ta_51_email_message_id}},\n\t\t\t\t\"campaign_id\":{{ta_51_mailing_id}},\n\t\t\t\t\"sending_connection_id\":{{esp_id}}\n\t\t\t},\n\t\t\t\"active\":true,\n\t\t\t\"position\":0\n\t\t},\n        {\n        \t\"name\": \"TA-51 Webhook Action\",\n            \"action_number\": 2,\n            \"type\": \"webhook\",\n            \"data\": {\n                \"http_method\": \"post\",\n                \"url\": \"https://automated_tests-l2.ongage.net/webhook_testing/ta51\",\n                \"selected_fields\": [\n                    \"email\",\n                    \"address\",\n                    \"country\"\n                ]\n            },\n            \"active\": true,\n            \"position\": 1\n        },\n        {\n        \t\"name\": \"TA-51 Update Field Action\",\n            \"action_number\": 3,\n            \"type\": \"update_field\",\n            \"data\": {\n                \"field_id\": {{list_field_last_name}},\n                \"operator\": \"overwrite\",\n                \"value\": \"{{last_name}}\"\n            },\n            \"active\": true,\n            \"position\": 2\n        },\n        {\n        \t\"name\": \"TA-51 Webhook Action 2\",\n            \"action_number\": 4,\n            \"type\": \"webhook\",\n            \"data\": {\n                \"http_method\": \"post\",\n                \"url\": \"https://automated_tests-l2.ongage.net/webhook_testing/ta51\",\n                \"selected_fields\": [\n                    \"country\",\n                    \"last_name\"\n                ]\n            },\n            \"active\": true,\n            \"position\": 3\n        },\n        {\n        \t\"name\": \"TA-51 Update Field Action 2\",\n            \"action_number\": 5,\n            \"type\": \"update_field\",\n            \"data\": {\n                \"field_id\": {{list_field_last_name}},\n                \"operator\": \"overwrite\",\n                \"value\": \"{{first_name}}\"\n            },\n            \"active\": true,\n            \"position\": 4\n        }\n    ]\n}"
				},
				"url": {
					"raw": "{{api_domain}}/{{list_id}}/api/automation_rule/{{automation_rule_id}}",
					"host": [
						"{{api_domain}}"
					],
					"path": [
						"{{list_id}}",
						"api",
						"automation_rule",
						"{{automation_rule_id}}"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get automation info",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"var jsonData = pm.response.json();",
							"",
							"pm.test(\"Test active automation rule with criteria and actions update\", function() {",
							"    pm.expect(jsonData.payload.active).to.eql(true);",
							"   // pm.expect(jsonData.payload.criteria[2].operand[0]).to.eql(\"opened\");",
							"    pm.expect(jsonData.payload.actions[0].data['message_id']).to.eql(parseInt(pm.environment.get(\"ta_51_email_message_id\")));",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"protocolProfileBehavior": {
				"disableBodyPruning": true
			},
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "X_USERNAME",
						"type": "text",
						"value": "{{username}}"
					},
					{
						"key": "X_PASSWORD",
						"type": "text",
						"value": "{{password}}"
					},
					{
						"key": "X_ACCOUNT_CODE",
						"type": "text",
						"value": "{{account_code}}"
					},
					{
						"key": "Content-Type",
						"name": "Content-Type",
						"type": "text",
						"value": "text/plain"
					}
				],
				"body": {
					"mode": "raw",
					"raw": ""
				},
				"url": {
					"raw": "{{api_domain}}/{{list_id}}/api/automation_rule/{{automation_rule_id}}?include_actions=1",
					"host": [
						"{{api_domain}}"
					],
					"path": [
						"{{list_id}}",
						"api",
						"automation_rule",
						"{{automation_rule_id}}"
					],
					"query": [
						{
							"key": "include_actions",
							"value": "1"
						}
					]
				}
			},
			"response": []
		},
		{
			"name": "Deactivate automation rule",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "PUT",
				"header": [
					{
						"key": "X_USERNAME",
						"type": "text",
						"value": "{{username}}"
					},
					{
						"key": "X_PASSWORD",
						"type": "text",
						"value": "{{password}}"
					},
					{
						"key": "X_ACCOUNT_CODE",
						"type": "text",
						"value": "{{account_code}}"
					},
					{
						"key": "Content-Type",
						"name": "Content-Type",
						"type": "text",
						"value": "text/plain"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\"active\": false}"
				},
				"url": {
					"raw": "{{api_domain}}/{{list_id}}/api/automation_rule/{{automation_rule_id}}",
					"host": [
						"{{api_domain}}"
					],
					"path": [
						"{{list_id}}",
						"api",
						"automation_rule",
						"{{automation_rule_id}}"
					]
				}
			},
			"response": []
		},
		{
			"name": "Delete automation rule",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.globals.unset(\"automation_rule_id\");",
							"",
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "DELETE",
				"header": [
					{
						"key": "X_USERNAME",
						"type": "text",
						"value": "{{username}}"
					},
					{
						"key": "X_PASSWORD",
						"type": "text",
						"value": "{{password}}"
					},
					{
						"key": "X_ACCOUNT_CODE",
						"type": "text",
						"value": "{{account_code}}"
					}
				],
				"body": {
					"mode": "raw",
					"raw": ""
				},
				"url": {
					"raw": "{{api_domain}}/{{list_id}}/api/automation_rule/{{automation_rule_id}}",
					"host": [
						"{{api_domain}}"
					],
					"path": [
						"{{list_id}}",
						"api",
						"automation_rule",
						"{{automation_rule_id}}"
					]
				}
			},
			"response": []
		}
	]
}